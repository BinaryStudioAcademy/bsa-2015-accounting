#budgets-view
	form.editCanges
		button.btn.btn-primary(type='submit') save changes
		button.btn.btn-danger(type='button') discard changes

	table.table.table-bordered.table-hover.table-condensed
		thead
			tr
				th(colspan='2') Category
				th Budget
				th Used
			tr
				td(colspan='2')
					select#years(ng-model='budCtrl.year', ng-change="budCtrl.updateYear()")
						option(ng-repeat='year in budCtrl.years', value='{{year}}') {{year}}
				td {{budCtrl.annualBudget | currency}} (
					span(ng-class="{'status-good': (budCtrl.annualUndistributed > 0), 'status-bad': (budCtrl.annualUndistributed < 0)}") {{budCtrl.annualUndistributed | currency}} 
					| undistributed)
				td {{budCtrl.annualUsed | currency}} (
					span(ng-class="{'status-good': (budCtrl.annualBudget - budCtrl.annualUsed > 0), 'status-bad': (budCtrl.annualBudget - budCtrl.annualUsed < 0)}") {{budCtrl.annualBudget - budCtrl.annualUsed | currency}} 
					| left)

		tbody(ng-repeat='category in budCtrl.categories')
			tr
				th(class="review" )
					button.btn.btn-xs.btn-warning(ng-click="budCtrl.toggleCustom($index)" ng-show="!budCtrl.hiddenList[$index]")
						i.fa.fa-caret-right
					button.btn.btn-xs.btn-warning(ng-click="budCtrl.toggleCustom($index)" ng-hide="!budCtrl.hiddenList[$index]")
						i.fa.fa-caret-down
					form.form-buttons.form-inline(editable-form='', name='rowform', ng-show='rowform.$visible',	shown='inserted == category')
						button.btn.btn-xs.btn-primary(type='submit', ng-disabled='rowform.$waiting')
							| save
						button.btn.btn-xs.btn-default(type='button', ng-disabled='rowform.$waiting', ng-click='rowform.$cancel()')
							| cancel
					.buttons(ng-show='!rowform.$visible')
						button.btn.btn-xs.btn-primary(ng-click='rowform.$show()') edit
						button.btn.btn-xs.btn-danger(ng-click='removeUser($index)') del
				th
					span(editable-text='category.name' name='name' e-form='rowform') {{ category.name || 'empty' }}
				th 
					span(editable-number='category.budget' name='budget' e-form='rowform') {{category.budget || 'empty' | currency}} 
					| (
					span(ng-class="{'status-good': (category.undistributed > 0), 'status-bad': (category.undistributed < 0)}") {{category.undistributed | currency}} 
					| undistributed)
				th {{category.used | currency}} (
					span(ng-class="{'status-good': (category.budget - category.used > 0), 'status-bad': (category.budget - category.used < 0)}") {{category.budget - category.used | currency}} 
					| left)



			tr.hide-list(ng-repeat='subcategory in category.subcategories' ng-hide="!budCtrl.hiddenList[$parent.$index]")
				td
					form.form-buttons.form-inline(editable-form='', name='rowform', ng-show='rowform.$visible',	shown='inserted == subcategory')
						button.btn.btn-xs.btn-primary(type='submit', ng-disabled='rowform.$waiting')
							| save
						button.btn.btn-xs.btn-default(type='button', ng-disabled='rowform.$waiting', ng-click='rowform.$cancel()')
							| cancel
					.buttons(ng-show='!rowform.$visible')
						button.btn.btn-xs.btn-primary(ng-click='rowform.$show()') edit
						button.btn.btn-xs.btn-danger(ng-click='removeUser($index)') del
				td
					span(editable-text='subcategory.name', e-name='subcategory.name', e-form='rowform', e-required='')
						|{{subcategory.name || 'empty' }}
				td
					span(editable-number='subcategory.budget', e-name='subcategory.udget', e-form='rowform')
						| {{ subcategory.budget || 'empty' | currency }}
				td {{subcategory.used | currency}} (
					span(ng-class="{'status-good': (subcategory.budget - subcategory.used > 0), 'status-bad': (subcategory.budget - subcategory.used < 0)}") {{subcategory.budget - subcategory.used | currency}} 
					| left)
				
			tr(ng-hide="!budCtrl.hiddenList[$index]")
				th(colspan='4')
					a 
						| new subcategory in {{category.name}} 
						i.fa.fa-plus 
		tbody
			tr
				th(colspan='4')
					a(ng-click="budCtrl.addBudget()")
						| new category in year {{budCtrl.year}} 
						i.fa.fa-plus
