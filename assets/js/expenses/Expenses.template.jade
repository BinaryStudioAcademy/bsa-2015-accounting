#expenses-view
	button#responsive-btn.btn.btn-primary(ng-click="isRightBlockShow = !isRightBlockShow")
		| New expense&nbsp;
		i.fa.fa-chevron-right(ng-show="!isRightBlockShow")
		i.fa.fa-chevron-down(ng-show="isRightBlockShow")
	#rightBlock(ng-class="{showBlock: isRightBlockShow}")
		.exchange
			b Today currency exchange rate
			br
			|{{exchangeRate}} UAH for 1 USD
		form.expense-form(name="expenseForm", ng-controller="ExpenseFormController as formCtrl",
		ng-submit="expenseForm.$valid && formCtrl.createExpense(categoryModel, subcategoryModel)", novalidate)
			input.form-control(type="text", name='Name', placeholder='Expense', ng-model="formCtrl.expense.name", typeahead="expense.name for expense in expCtr.allExpenses | filter:$viewValue | limitTo:8", required)
			input.form-control(type='date', name='Date', placeholder='Date', ng-model="formCtrl.date", required)
			select(name='Category', ng-model="categoryModel", ng-change="formCtrl.getSubcategories(categoryModel)",
			ng-options="category.name for category in formCtrl.categories", required)
				option(value="") Category
			select(name='Subcategory', ng-model="subcategoryModel",
			ng-options="subcategory.name for subcategory in formCtrl.subcategories", ng-change="formCtrl.setLeftSubcategoryBudget(categoryModel, subcategoryModel)", required)
				option(value="") Subcategory
			input.form-control(type='number', min="0", name='Cost', placeholder='Cost', ng-model="formCtrl.expense.price", required)
			select.form-control(name='Currency', ng-model="formCtrl.expense.currency", ng-change="formCtrl.changeCurrency(categoryModel, subcategoryModel)", required)
				option USD
				option UAH
			#personal-container
				input(type='checkbox', name='Personal', ng-model="formCtrl.expense.personal", ng-click="formCtrl.setPersonalLeftBudget(categoryModel, subcategoryModel)")
				span#personal-label Personal budget
			textarea.form-control(placeholder='Description', ng-model="formCtrl.expense.description")
			.money-left(ng-show="subcategoryModel")
				#form-category-left
					b {{formCtrl.budgetType}} budget left:
					span.green  {{formCtrl.leftBudget - formCtrl.expense.price | currency:""}} {{formCtrl.expense.currency}}
				#form-subcategory-left(ng-hide="formCtrl.expense.personal")
					br
					b {{subcategoryModel.name}} budget left:&nbsp;
					span.green {{formCtrl.leftSubcategoryBudget - formCtrl.expense.price | currency:""}} {{formCtrl.expense.currency}}
			button.btnAdd.btn.btn-primary(type="submit") Add expense
	#leftBlock
		.filters
			form
				input(type='text', name='cost-range', placeholder='Expense', ng-model="nameModelFilter")
				select(name='category', ng-model="categoryModelFilter", ng-change="expCtr.getSubcategories(categoryModelFilter.id)", ng-options="category.name for category in expCtr.categories")
					option(value="") Category
				select(name='subcategory', ng-model="subcategoryModelFilter", ng-options="subcategory.name for subcategory in expCtr.subcategories")
					option(value="") Subcategory
				input(type="text", name='author', placeholder='Author', ng-model="authorModelFilter", typeahead="expense.creator.name for expense in expCtr.allExpenses | filter:$viewValue | limitTo:8")
				a#excel-button.btn.btn-success(ng-click='expCtr.exportData(filteredData)') Export to Excel
					i.fa.fa-file-excel-o.fa-1g
				input(type='date', name='startDate', placeholder='Date', ng-model="startDateFilter")
				input(type='date', name='endDate', placeholder='Date', ng-model="endDateFilter")

		table.table-hover.fixed
			colgroup
				col.table-toggle.responsive-hide
				col.table-date-header.responsive-hide
				col.table-category
				col.table-expense.responsive-hide
				col.table-cost
				col.table-carrency
				col.table-sub
				col.table-addBy.responsive-hide
				col.table-description-header.responsive-hide
			thead
				tr
					th.responsive-hide
						button.fa.fa-list(ng-click='expCtr.toggleAllExpenses()' ng-show='expCtr.check')
						button.fa.fa-th(ng-click='expCtr.toggleAllExpenses()' ng-hide='expCtr.check')
					th.responsive-hide
						span(ng-click="sortType = 'time'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Time&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'time' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'time' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'time'")
					th
						span(ng-click="sortType = 'category.name'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Category&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'category.name' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'category.name' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'category.name'")
					th#header-sub.responsive-hide
						span(ng-click="sortType = 'subcategory.name'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Subcategory&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'subcategory.name' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'subcategory.name' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'subcategory.name'")
					th
						span(ng-click="sortType = 'name'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Name&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'name' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'name' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'name'")
					th
						span(ng-click="sortType = 'currencySort'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Amount&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'currencySort' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'currencySort' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'currencySort'")
					th
						.currency-group.btn-group(ng-click="expCtr.changeCurrency()")
							label.btn.btn-primary(ng-model="expCtr.currencyModel", btn-radio="'UAH'") UAH
							label.btn.btn-primary(ng-model="expCtr.currencyModel", btn-radio="'USD'") USD
					th.responsive-hide
						span(ng-click="sortType = 'creator.name'; sortReverse = !sortReverse; expCtr.sort(sortType, sortReverse)") Added by&nbsp;
							span.fa.fa-caret-down(ng-show="sortType == 'creator.name' && !sortReverse")
							span.fa.fa-caret-up(ng-show="sortType == 'creator.name' && sortReverse")
							span.fa.fa-sort(ng-hide="sortType == 'creator.name'")
					th.responsive-hide
						i.fa.fa-cog
		#main
			table.table-hover.fixed(ng-if="!sortType")
				colgroup
					col.table-date.responsive-hide
					col.table-category
					col.table-expense.responsive-hide
					col.table-cost
					col.table-carrency
					col.table-sub
					col.table-addBy.responsive-hide
					col.table-description.responsive-hide
				tbody(ng-repeat="date in expCtr.dates | limitTo: expCtr.expensesLimit track by $index", ng-hide="!(filteredData = (expCtr.getExpensesByDate(date) " +
				"| filter: {name: nameModelFilter, category: {name: categoryModelFilter.name}, " +
				"subcategory: {name: subcategoryModelFilter.name}, creator: {name: authorModelFilter}} " +
				"| dateRange:startDateFilter:endDateFilter)).length")
					tr.date-hilight
						td
							i.fa.fa-chevron-right(ng-click="expCtr.toggleCustom($index)" ng-hide="!expCtr.hiddenList[$index]" )
							i.fa.fa-chevron-down(ng-click="expCtr.toggleCustom($index)" ng-show="!expCtr.hiddenList[$index]")
						td(colspan='7')

							| {{ date | date: 'fullDate' }}
					tr(ng-repeat="expense in filteredData", ng-init='expCtr.pageTitleEquals(filteredData)', ng-hide="expCtr.hiddenList[$parent.$index]" )
						td.responsive-hide
							| {{ expense.time | date:'HH:mm' }}
						td
							span(editable-select='expense.category.id', e-name='category.name', onshow="expCtr.getSubcategories($data)", e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "categoryId")', e-ng-options='category.id as category.name for category in expCtr.categories' e-ng-change="expCtr.getSubcategories($data)", e-required="")
								| {{ expCtr.getField(expense.category.id, "category") || 'empty' }}
						td.responsive-hide
							span(editable-select='expense.subcategory.id', e-name='subcategory.name', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "subcategoryId")', onbeforesave="expCtr.checkField($data)", e-ng-options='subcategory.id as subcategory.name for subcategory in expCtr.subcategories', e-required="")
								| {{ expCtr.getField(expense.subcategory.id, "subcategory") || expense.subcategory.name }}
						td
							span(editable-text='expense.name', e-name='name', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "name")', onbeforesave="expCtr.checkField($data)", e-required="")
								| {{ expense.name || 'empty' }}
						td
							span(editable-number='expense.price', e-name='price', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "price")', onbeforesave="expCtr.checkField($data)", e-required="")
								| {{ expense.newPrice | currency:'' }}
						td
							span(editable-select='expense.currency', e-name='currency', e-form='rowform', e-ng-options='currency for currency in expCtr.currency', onaftersave='expCtr.editExpenseObject($data, "currency")' e-required="")
								| {{ expCtr.currencyModel }}
						td.responsive-hide
							span(e-name='creator', e-form='rowform') {{ expense.creator.name }}
						td.responsive-hide
							form.form-buttons.form-inline(editable-form='', name='rowform', ng-show='rowform.$visible', onaftersave="expCtr.editExpense(expense.id)", shown='inserted == expense')

								button.btn-xs.btn.btn-success.fa.fa-check(type='submit', ng-disabled='rowform.$waiting')
								button#delete-button.btn-xs.btn.btn-warning.fa.fa-ban(type='button', ng-disabled='rowform.$waiting', ng-click='rowform.$cancel()')
							.buttons(ng-show='!rowform.$visible && expCtr.isUserExpense(expense.creator.global_id, expense.category.id)')
								button.btn-xs.btn.btn-primary.edit-button.fa.fa-pencil(ng-click='rowform.$show()')
								button.btn-xs.btn.btn-danger.fa.fa-trash-o(ng-click="expCtr.deleteExpense(expense.id, expense.name)")
							.btn-group(dropdown='')
								button.btn.fa.fa-info(ng-show='!rowform.$visible' type='button', dropdown-toggle='')
								span.dropdown-menu.dropdown-menu-right(editable-text='expense.description', e-name='description' e-form='rowform' role='menu', aria-labelledby='split-button' onaftersave='expCtr.editExpenseObject($data, "description")') {{ expense.description }}
				tbody(ng-show="expCtr.isLoadMore()")
					tr
						td
						td(colspan='7')
							a(ng-click="expCtr.loadExpenses(); expCtr.pushList(true)")
								| load more expenses&nbsp;
								i.fa.fa-plus
			// filter table
			table.table-hover.fixed(ng-if="sortType")
				colgroup
					col.table-date.responsive-hide
					col.table-category
					col.table-expense.responsive-hide
					col.table-cost
					col.table-carrency
					col.table-sub
					col.table-addBy.responsive-hide
					col.table-description.responsive-hide
				tbody
					tr(ng-repeat="expense in expCtr.sortedExpenses | limitTo: expCtr.expensesLimit")
						td.responsive-hide
							| {{ expense.time | date:'dd.MM.yyyy' }}
						td
							span(editable-select='expense.category.id', e-name='category.name', onshow="expCtr.getSubcategories($data)", e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "categoryId")', e-ng-options='category.id as category.name for category in expCtr.categories' e-ng-change="expCtr.getSubcategories($data)", e-required="")
								| {{ expCtr.getField(expense.category.id, "category") || 'empty' }}
						td.responsive-hide
							span(editable-select='expense.subcategory.id', e-name='subcategory.name', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "subcategoryId")', onbeforesave="expCtr.checkField($data)", e-ng-options='subcategory.id as subcategory.name for subcategory in expCtr.subcategories', e-required="")
								| {{ expCtr.getField(expense.subcategory.id, "subcategory") || expense.subcategory.name }}
						td
							span(editable-text='expense.name', e-name='name', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "name")', onbeforesave="expCtr.checkField($data)", e-required="")
								| {{ expense.name  || 'empty' }}
						td
							span(editable-number='expense.price', e-name='price', e-form='rowform', onaftersave='expCtr.editExpenseObject($data, "price")', onbeforesave="expCtr.checkField($data)", e-required="")
								| {{ expense.newPrice | currency:'' }}
						td
							span(editable-select='expense.currency', e-name='currency', e-form='rowform', e-ng-options='currency for currency in expCtr.currency', onaftersave='expCtr.editExpenseObject($data, "currency")' e-required="")
								| {{ expCtr.currencyModel }}
						td.responsive-hide
							span(e-name='creator', e-form='rowform') {{ expense.creator.name }}
						td.responsive-hide
							form.form-buttons.form-inline(editable-form='', name='rowform', ng-show='rowform.$visible', onaftersave="expCtr.editExpense(expense.id)", shown='inserted == expense')

								button.btn-xs.btn.btn-success.fa.fa-check(type='submit', ng-disabled='rowform.$waiting')
								button#delete-button.btn-xs.btn.btn-warning.fa.fa-ban(type='button', ng-disabled='rowform.$waiting', ng-click='rowform.$cancel()')
							.buttons(ng-show='!rowform.$visible && expCtr.isUserExpense(expense.creator.global_id, expense.category.id)')
								button.btn-xs.btn.btn-primary.edit-button.fa.fa-pencil(ng-click='rowform.$show()')
								button.btn-xs.btn.btn-danger.fa.fa-trash-o(ng-click="expCtr.deleteExpense(expense.id, expense.name)")
							.btn-group(dropdown='')
								button.btn.fa.fa-info(ng-show='!rowform.$visible' type='button', dropdown-toggle='')
								span.dropdown-menu.dropdown-menu-right(editable-text='expense.description', e-name='description' e-form='rowform' role='menu', aria-labelledby='split-button' onaftersave='expCtr.editExpenseObject($data, "description")') {{ expense.description }}
				tbody(ng-show="expCtr.isLoadMore()")
					tr
						td
						td(colspan='7')
							a(ng-click="expCtr.loadExpenses(); expCtr.pushList(true)")
								| load more expenses&nbsp;
								i.fa.fa-plus
